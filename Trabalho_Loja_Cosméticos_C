#include <stdio.h>
#include <stdlib.h>

int main() {
    int opcao, opcao2;
    char nomeProduto[50];
    float preco = 0.0;
    char marcaProduto[50];
    int quantidadeProduto = 0;
    int quantidadeCompra;
    float dinheiro;
    float resultadoCompra;
    float troco;
    int numeroParcelas;

    do {
        printf("\n--- MENU ---\n");
        printf("1 - Cadastrar Produto\n");
        printf("2 - Mostrar Estoque\n");
        printf("3 - Vender Produto\n");
        printf("0 - Sair\n");
        printf("Escolha uma opcao: ");
        scanf("%d", &opcao);

        switch (opcao) {
            case 1:
                printf("\n--- CADASTRAR PRODUTO ---\n");
                printf("Nome do Produto: ");
                getchar(); // Limpa o buffer
                fgets(nomeProduto, sizeof(nomeProduto), stdin);

                printf("Marca do Produto: ");
                fgets(marcaProduto, sizeof(marcaProduto), stdin);

                printf("Preco: ");
                scanf("%f", &preco);

                printf("Quantidade: ");
                scanf("%d", &quantidadeProduto);

                printf("\nProduto cadastrado com sucesso!\n");
                break;

            case 2:
                printf("\n--- ESTOQUE ---\n");
                if (quantidadeProduto > 0) {
                    printf("Produto: %s", nomeProduto);
                    printf("Marca: %s", marcaProduto);
                    printf("Preco: R$ %.2f\n", preco);
                    printf("Quantidade: %d\n", quantidadeProduto);
                } else {
                    printf("\nNenhum produto cadastrado ou estoque vazio.\n");
                }
                break;

                printf("\n--- VENDA ---\n");
                printf("Quantidade desejada: ");
                scanf("%d", &quantidadeCompra);

                if (quantidadeCompra > quantidadeProduto) {
                    printf("Temos apenas %d unidades. Deseja comprar toda a quantidade disponivel? (1-Sim / 0-Nao): ", quantidadeProduto);
                    int continuar;
                    scanf("%d", &continuar);
                   
                if (continuar == 1) {
                    quantidadeCompra = quantidadeProduto;
                   
                } else if (continuar == 0) {
                    printf("\nCompra cancelada.\n");
                break;
               
                 } else {
                     printf("\nOpcao invalida! Compra cancelada.\n");
                break;
                        }
                }

                resultadoCompra = preco * quantidadeCompra;

                printf("\n-- Forma de Pagamento --\n");
                printf("1 - Dinheiro\n");
                printf("2 - Cartao Debito\n");
                printf("3 - Cartao Credito\n");
                printf("0 - Cancelar Compra\n");
                printf("Escolha forma de pagamento: ");
                scanf("%d", &opcao2);

        switch (opcao2) {
            case 1:
                    printf("\nOpcao: Dinheiro\n");
                    printf("Total: R$ %.2f\n", resultadoCompra);
                    printf("Valor entregue: R$ ");
                    scanf("%f", &dinheiro);
                   
                if (dinheiro < resultadoCompra) {
                    printf("\nValor insuficiente! Venda cancelada.\n");
                }else{
                    troco = dinheiro - resultadoCompra;
                   
                    printf("Troco: R$ %.2f\n", troco);
                            quantidadeProduto -= quantidadeCompra;
                    }
                    break;

            case 2:
                    printf("Opcao: Cartao Debito\n");
                    printf("Total: R$ %.2f\n", resultadoCompra);
                    printf("\nCompra de R$ %.2f realizada com sucesso.\n", resultadoCompra);
                       
                    quantidadeProduto -= quantidadeCompra;
                        break;

            case 3:
                    printf("\nOpcao: Cartao Credito\n");
                    printf("Total: R$ %.2f\n", resultadoCompra);
                    printf("SerÃ¡ parcelado em quantas vezes?: ");
                    scanf("%d", &numeroParcelas);


                if(numeroParcelas >= 1 && numeroParcelas <= 6){
                           
                    float parcelas = resultadoCompra / numeroParcelas;
                   
                    printf("Cada parcela ficou: R$ %.2f\n ", parcelas);
                    printf("\nCompra realizada com sucesso.\n", resultadoCompra);
                        quantidadeProduto -= quantidadeCompra;
                       
                } else {
                        printf("\nNumero de parcelas invalido (Escolha somente de 1 a 6 parcelas), Venda cancelada.\n");
                        }
                        break;

            case 0:
                    printf("\nCompra cancelada.\n");
                        break;

                default:
                    printf("\nOpcao invalida.\n");
                        break;
                }
                break;

            case 0:
                    printf("\nSaindo do sistema. Ate mais!\n");
                break;

            default:
                printf("\nOpcao invalida! Tente novamente.\n");
                break;
        }
    } while (opcao != 0);

    return 0;
}
